version: 0.2

phases:
  pre_build:
    commands:
      - echo Logging in to Amazon ECR...
      - aws ecr get-login --no-include-email --region us-east-1

  build:
    commands:
      - echo Build started on `date`
      - echo Building the Docker image...          
      - docker build -t plm-test .
      - docker tag plm-test:latest 966944937428.dkr.ecr.us-east-1.amazonaws.com/plm-test:latest      
  post_build:
    commands:
      - echo Build completed on `date`
      - echo Pushing the Docker image...
      - docker login -u AWS -p eyJwYXlsb2FkIjoiT2oyaVpYK1NkRDMxeTJvZzU4ejcyUjFMNCtvMVdzc1l2QWRBMzlrZUM3Lzl5elliWnh1UTN1QUpIYUwyMFYzdnRFZkZDQzc5N1EwTDNsZ1Q5SmRvYlV1ZVh6K3RNR214Y0dOZDNOcUNDeWk2YkY1NWNud2JoNHhMRXIrYk9UY3hMVXNHTFMxbFJHOTlXSkFKR3A0aTE1YW45QmRmNkxoV3JGbHk0QXZuQ0dueFZlNU1IVWl2ZG90SXV6YVFwRFR5a1h5dm5lbktPS05xNFQxNXJuL0hqS2NqdXo1MllLN0JQYnlXTWhPaEIwYmxyTytBbG02VncvdnR6VzQramFiY29KUzVXUlYzb2dQQjhaeEsya1c3VThDeDRBc3B4b2ZndGRxcnRPRjhsU1lJZ1BFK0dnVTgwS0VKV21RR3VjYStNdElZQkdvRURoS2dhNFRvT0w3M0FpZmszVXhCeVdJeThCbEdIS1NDTDhmNWRidHN6QzhEUXh0K2lScTQ3UFlpSG5qN2l5SFdRRWFvdE1laFRzMW1QcnpzV1FBY1JnMERjMGVZKzA1ZCtpd08vSWxOVXJUUlZvUEdLZ1RkaUQzNkZTVUVuUjE1Sjc3VlN5VVlMODM3UHpRN1p0L1lRVDk0elNlNUFFWm1sb2RRNWZwQlFnOHBVeTlZNVhoaHNrS2tCRnpwZFZBM3BzOThyb3FHaEREVW5PaXFpUmRqclRFUENyY25FWmZiT2s4dHFqVlBGZHlNaGlva2pHc21aU05Dd2xYVHFKaTNZWG16aFV5blZVNkZVSEFnMmFsRXJzU1k1cXJDeWN6a25oZCtncU1yQ1J5MURUZW9jeGJ1KytEd2duc0JiTWg4MURoc1dkNjQ3dEI2cCt4YXZWOFUxYWFSdEFoaUQxVG9YbENLanBmVWpXT2ZPRHVKTFBKczgxenJ1RnVBUCtpOTcyTnpleDd4bTg5OCtqRjFOTGpTRE5nTEVWUVN2b3RkcmNoY25ka0FyN0lTMlVvNmZ0RHdwdllUL1hHZXRocFlxSm51U2RBQXM2bDFTb3UwODdrOUFocEdKcXlnblhxYjNIeHF4dW5ZcmpURXEvSit4NEh2N0w0N1N5cnNsUFNzc0cydVR6K3hRVUdoSFlmSmVzRFNLUFV2MzZkdmRUUTc1SjRSLy8zTjBpdktBamV0dHpSWVFzNHY2dS9kUkhsQ245dkx2T2RMN2M5WTFLNGFMUG1JTjljQ0l1OVgwME9NbUE2dVJwaDNSYmdGY2I4Z3RaQUhZL1lzV0Q5ZVpKZ1RuaUt0dzdTMWdhSHlQaHdudngyWUQxLytPaWNxMTNlQTlTeGxIdjJZczRYNjd0RW45dmtHa3U2RGpkUFJiWDVyeXhscGliN0t5bm9Nc1ZOUWd5VU5XZFVyQmNobUJNbCtTWGx6RjB6TnhqOTgvSTBybTN2TWF5L0w0V1MraURwSDdnWmUxNEw3V3BiTmt5V2JMMXRmWDJSdlNKc3UvK3UzIiwiZGF0YWtleSI6IkFRRUJBSGh3bTBZYUlTSmVSdEptNW4xRzZ1cWVla1h1b1hYUGU1VUZjZTlScTgvMTR3QUFBSDR3ZkFZSktvWklodmNOQVFjR29HOHdiUUlCQURCb0Jna3Foa2lHOXcwQkJ3RXdIZ1lKWUlaSUFXVURCQUV1TUJFRURKalluRVRURjkyTkpYTFlHd0lCRUlBN21uQ1h6bHVSU2dWako4WlpleHhIN3p5VnBqbGtzYzRhRlgrYnFmS2MzSmdWQTJMd1dhYmJrVVErNmtKRy8wU2twTkU4dVZpV1RFR1o1cEE9IiwidmVyc2lvbiI6IjIiLCJ0eXBlIjoiREFUQV9LRVkiLCJleHBpcmF0aW9uIjoxNTIzOTQxMjM3fQ== -e none https://966944937428.dkr.ecr.us-east-1.amazonaws.com
      - docker push 966944937428.dkr.ecr.us-east-1.amazonaws.com/plm-test:latest
     
